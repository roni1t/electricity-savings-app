(קוד כפי שבוצע קודם – הוכנס בקובץ נפרד לשם הפשטה)